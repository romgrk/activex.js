function getRepository(){function b(a){if(void 0==a)return"";var b=[];for(var c in a){var d=a[c];b.push(c+" = '"+d.replace(/'/g,"''")+"'")}return b.join(" AND ")}function c(){this._groups=[]}function d(a){this.name=a,this._updateKeys()}var a=new ActiveXObject("RepositoryLib.WorkflowRepository");return c.prototype.addGroup=function(b,c){return a.AddGroup(b,JSON.stringify(c)),this.getGroup(b)},c.prototype.removeGroup=function(b){"string"==typeof b?a.RemoveGroup(b):a.RemoveGroup(b.name)},c.prototype.renameGroup=function(b,c){if(a.RenameGroup(b,c),void 0!=this._groups[b]){var d=this._groups[b];delete this._groups[b],d.name=c,this._groups[c]=d}},c.prototype.listGroups=function(){return JSON.parse(a.ListGroups())},c.prototype.getGroup=function(a){return void 0==this._groups[a]&&(this._groups[a]=new d(a)),this._groups[a]},c.prototype.clear=function(){a.ClearAllData()},d.prototype._updateKeys=function(a){this._keys=this.listKeys(),this._keysString=JSON.stringify(["ID"].concat(this._keys))},d.prototype.listKeys=function(){var b=[],c=JSON.parse(a.ListKeys(this.name));for(var d in c)"meta"!=c[d]&&b.push(d);return b},d.prototype.addKey=function(b){a.AddKey(this.name,b),this._updateKeys()},d.prototype.removeKey=function(b){a.RemoveKey(this.name,b),this._updateKeys()},d.prototype.find=function(a){return this.findAll(b(a))[0]},d.prototype.findAll=function(c){var d=a.GetKeySets(this.name,this._keysString,b(c));return JSON.parse(d)},d.prototype.query=function(b){var c=a.GetKeySets(this.name,this._keysString,b);return JSON.parse(c)},d.prototype.insert=function(b){b.constructor==Array?a.AddKeySets(this.name,JSON.stringify(b)):a.AddKeySets(this.name,JSON.stringify([b]))},d.prototype.update=function(b){var c=b.ID;for(var d in this._keys){var e=this._keys[d],f=b[e];a.SetValueByID(this.name,e,f,c)}},d.prototype.remove=function(c){"number"==typeof c?a.RemoveKeySetByID(this.name,c):c.ID?a.RemoveKeySetByID(this.name,c.ID):a.RemoveKeySets(this.name,b(c))},d.prototype.clear=function(){a.ClearGroupData(this.name)},new c}